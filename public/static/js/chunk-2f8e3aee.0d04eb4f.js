(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f8e3aee"],{4:function(e,t){},5:function(e,t){},6:function(e,t){},7:function(e,t){},"9ed6":function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",[s("h1",[e._v("登入")]),e._v(" "),e.loggingIn?s("div"):e._e(),e._v(" "),e.errorMessage?s("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[e._v("\n    "+e._s(e.errorMessage)+"\n  ")]):e._e(),e._v(" "),e.loggingIn?e._e():s("form",{on:{submit:function(t){return t.preventDefault(),e.login()}}},[s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"username"}},[e._v("使用者名稱")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.username,expression:"user.username"}],staticClass:"form-control",attrs:{id:"username",type:"text","aria-describedby":"usernameHelp",placeholder:"輸入使用者名稱",required:""},domProps:{value:e.user.username},on:{input:function(t){t.target.composing||e.$set(e.user,"username",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"password"}},[e._v("密碼")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.password,expression:"user.password"}],staticClass:"form-control",attrs:{id:"password",type:"password","aria-describedby":"passwordHelp",placeholder:"輸入密碼",required:""},domProps:{value:e.user.password},on:{input:function(t){t.target.composing||e.$set(e.user,"password",t.target.value)}}})]),e._v(" "),s("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[e._v("登入")]),e._v(" "),s("router-link",{attrs:{to:"/register"}},[s("button",{staticClass:"btn-white",attrs:{type:"submit"}},[e._v("註冊")])])],1)])},a=[],o=(s("6762"),s("2fdb"),s("ac6a"),s("a8f8")),n=s("f0b1"),i=s.n(n),u=o["a"]+"/login",l=i.a.object().keys({username:i.a.string().regex(/(^[a-zA-Z0-9_]+$)/).min(2).max(30).required(),password:i.a.string().trim().min(8).required()}),c={data:function(){return{errorMessage:"",loggingIn:!1,user:{username:"",password:""},user1:{username:"",password:""}}},methods:{login:function(){var e=this;this.errorMessage="",this.loggingIn=!0,fetch(u,{method:"post",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({Username:this.user.username,Password:this.user.password})}).then((function(e){return e.json().then((function(t){return{data:t,status:e.status}}))})).then((function(t){console.log(t.status,t.data.token),401===t.status?(e.loggingIn=!1,e.errorMessage="login failed"):(console.log(t),t.data.AccountInfo.token?(localStorage.setItem("token",t.data.AccountInfo.token),localStorage.setItem("CompanyId",t.data.AccountInfo.CompanyId),localStorage.setItem("ProductId",t.data.AccountInfo.ProductId),localStorage.setItem("ProjectId",t.data.AccountInfo.ProjectId)):localStorage.setItem("token",""),e.user1.username="admin",e.user1.password="11111",e.$store.dispatch("user/login",e.user1),e.$store.state.signedIn=!0,e.loading=!1,setTimeout((function(){e.loggingIn=!1,e.$router.push("/admin/accounts/create")}),1e3))}))},validUser:function(){var e=i.a.validate(this.user,l);return null===e.error||(e.error.message.includes("username")?(this.errorMessage="Username is invalid. 😭",console.log(e.error.message)):this.errorMessage="Password is invalid. 🙈",!1)}}},d=c,m=s("2877"),g=Object(m["a"])(d,r,a,!1,null,null,null);t["default"]=g.exports},a8f8:function(e,t,s){"use strict";t["a"]="https://product.nadi3docms.com/api"}}]);